all: compile_client compile_server finished

################################################################################

obj/Socket.obj: src/Socket.cpp
	@echo "\033[1;35mGenerating \033[0;33m$@\033[0m"
	@g++ -c $^ -o $@

#-------------------------------------------------------------------------------

obj/Time.obj: src/Time.cpp
	@echo "\033[1;35mGenerating \033[0;33m$@\033[0m"
	@g++ -c $^ -o $@

#-------------------------------------------------------------------------------

obj/FileManager.obj: src/FileManager.cpp
	@echo "\033[1;35mGenerating \033[0;33m$@\033[0m"
	@g++ -c $^ -o $@

#-------------------------------------------------------------------------------

obj/Client.obj: src/Client.cpp
	@echo "\033[1;35mGenerating \033[0;33m$@\033[0m"
	@g++ -c $^ -o $@

#-------------------------------------------------------------------------------

obj/Server.obj: src/Server.cpp
	@echo "\033[1;35mGenerating \033[0;33m$@\033[0m"
	@g++ -c $^ -o $@

################################################################################

bin/Client: obj/Socket.obj obj/FileManager.obj obj/Time.obj obj/Client.obj
	@echo "\033[1;35mGenerating \033[0;33m$@\033[0m"
	@g++ -pthread $^ -o $@

#-------------------------------------------------------------------------------

bin/Server: obj/Socket.obj obj/FileManager.obj obj/Time.obj obj/Server.obj
	@echo "\033[1;35mGenerating \033[0;33m$@\033[0m"
	@g++ -pthread $^ -o $@

################################################################################

compile_client:compileMessage bin/Client
compile_server:compileMessage bin/Server

#-------------------------------------------------------------------------------

ip := 10.1.4.137
repetitions := 100

#-------------------------------------------------------------------------------

run_client:compile_client runClientMessage 
	@.\/bin/Client $(ip) 9000
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9001
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9002
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9003
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9004
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9005
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9006
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9007
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9008
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9009
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9010
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9011
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9012
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9013
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9014
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Client $(ip) 9015
	@make finished --no-print-directory

run_client_once:compile_client runClientMessage 
	@.\/bin/Client $(ip) 9000

#-------------------------------------------------------------------------------

run_server:compile_server runServerMessage 
	@.\/bin/Server 9000 $(repetitions) 65334KB.txt
	@rm output/output.csv
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9001 $(repetitions) 128KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9002 $(repetitions) 192KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9003 $(repetitions) 256KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9004 $(repetitions) 320KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9005 $(repetitions) 384KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9006 $(repetitions) 448KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9007 $(repetitions) 512KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9008 $(repetitions) 576KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9009 $(repetitions) 640KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9010 $(repetitions) 704KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9011 $(repetitions) 768KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9012 $(repetitions) 832KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9013 $(repetitions) 896KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9014 $(repetitions) 960KB.txt
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9015 $(repetitions) 1MB.txt
	@make finished --no-print-directory

run_server_png:compile_server runServerMessage 
	@.\/bin/Server 9000 $(repetitions) 1.png
	@rm output/output.csv
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9001 $(repetitions) 2.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9002 $(repetitions) 3.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9003 $(repetitions) 4.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9004 $(repetitions) 5.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9005 $(repetitions) 6.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9006 $(repetitions) 7.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9007 $(repetitions) 8.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9008 $(repetitions) 9.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9009 $(repetitions) 10.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9010 $(repetitions) 11.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9011 $(repetitions) 12.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9012 $(repetitions) 13.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9013 $(repetitions) 14.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9014 $(repetitions) 15.png
	@echo "\n\033[1;32m------------------------------------------------\033[0m"
	@.\/bin/Server 9015 $(repetitions) 16.png
	@make finished --no-print-directory

run_server_arg:
	@.\/bin/Server 9000 $(repetitions) $(file)

################################################################################

compileMessage:
	clear
	@echo "\033[1;31m------------------------------------------------\033[0m"
	@echo "\033[1;33m                   Compiling                    \033[0m"
	@echo "\033[1;31m------------------------------------------------\033[0m\n"

runClientMessage:
	@echo "\n\033[1;31m------------------------------------------------\033[0m"
	@echo   "\033[1;33m                 Running Client                 \033[0m"
	@echo   "\033[1;31m------------------------------------------------\033[0m"

runServerMessage:
	@echo "\n\033[1;31m------------------------------------------------\033[0m"
	@echo   "\033[1;33m                 Running Server                 \033[0m"
	@echo   "\033[1;31m------------------------------------------------\033[0m"

finished:
	@echo "\n\033[1;31m------------------------------------------------\033[0m"
	@echo   "\033[1;33m                    Finished                    \033[0m"
	@echo   "\033[1;31m------------------------------------------------\033[0m\n"

help:
	clear
	@echo "\033[1;31m------------------------------------------------\033[0m"
	@echo "\033[1;33m                      Help                      \033[0m"
	@echo "\033[1;31m------------------------------------------------\033[0m\n"
	@echo "\033[1m To run the client give as parameters:\033[0m"
	@echo "\033[1;32m 	1- \033[0mServer Ip\033[0m"
	@echo "\033[1;32m 	2- \033[0mPort number\033[0m"
	@echo "\033[1m To run the server give as parameters:\033[0m"
	@echo "\033[1;32m 	1- \033[0mPort number\033[0m"
	@echo "\033[1;32m 	2- \033[0mNumber of repetitions\033[0m"
	@echo "\033[1;32m 	3- \033[0mFile name\033[0m\n"
	@echo "\033[1;31m------------------------------------------------\033[0m"
	@echo "\033[1;33m                      Help                      \033[0m"
	@echo "\033[1;31m------------------------------------------------\033[0m\n"

################################################################################
